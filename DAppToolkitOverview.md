# DApp Toolkit Overview

Crypti's DApp Toolkit allows you to create new sidechains, change the forgers of a sidechain, and start developing your DApp with the minimum of effort.

When you generate a DApp using **crypti-cli** it clones the latest version of the toolkit from our [repository](https://github.com/crypti/testdapp) into your DApp's own repository.

In this tutorial, we will describe how to use the DApp Toolkit.

First, clone our [repository](https://github.com/crypti/testdapp) or just create a new DApp using **crypti-cli**.

### Directory Structure

Let's look at the toolkit and give an overview of its directory structure:

  * **modules** - Contains the backend code of your DApp.
  * **public** - Contains the frontend user interface of your DApp.
  * **blockchain.json** - JSON file describing the SQL database schema. You will need this if you want to store any data within your DApp.
  * **config.json** - JSON file containing your DApp's configuration data. By default this file defines a list of peers.
  * **genesis.json** - JSON file containing important information about your DApp's genesis block.
  * **index.js** - JavaScript file used to start your DApp.
  * **modules.full.json** - JSON file containing a list of defined modules, required by **index.js**.
  * **modules.genesis.json** - Pending Paul's description.
  * **routes.json** - JSON file defining the HTTP routes of every endpoint in your DApp's API.

Now let's look at the most important files and describe them further.

### Routes.json

This file, as described above, defines the HTTP routes of every API call. For example:

```json
[
	{
		"path": "/",
		"method": "get",
		"handler": "system.api.helloworld"
	},
	{
		"path": "/message",
		"method": "post",
		"handler": "system.api.message"
	},
	{
		"path": "/openAccount",
		"method": "post",
		"handler": "blockchain.accounts.open"
	},
	{
		"path": "/transaction",
		"method": "put",
		"handler": "blockchain.transactions.addTransaction"
	},
	{
		"path": "/transactions",
		"method": "get",
		"handler": "blockchain.transactions.getTransactions"
	},
	{
		"path": "/blocks/get",
		"method": "get",
		"handler": "blockchain.blocks.getBlock"
	},
	{
		"path": "/blocks",
		"method": "get",
		"handler": "blockchain.blocks.getBlocks"
	},
	{
		"path": "/blocks/after",
		"method": "get",
		"handler": "blockchain.blocks.getBlocksAfter"
	},
	{
		"path": "/blocks/height",
		"method": "get",
		"handler": "blockchain.blocks.getHeight"
	},
	{
		"path": "/blocks/common",
		"method": "get",
		"handler": "blockchain.blocks.findCommon"
	},
	{
		"path": "/blocks/count",
		"method": "get",
		"handler": "blockchain.blocks.count"
	},
  	{
		"path": "/withdrawal",
		"method": "post",
		"handler": "contracts.withdrawaltransfer.withdrawal"
	}
]
```

As you can see this file is comprised of an array of objects each representing the individual endpoints of our API. For example:

```json
{
	"path": "/",
	"method": "get",
	"handler": "system.api.helloworld"
}
```

  * **path** - The path to the API endpoint e.g. **/messages/add**.
  * **method** - The HTTP request method e.g. GET, POST, PUT, DEL.
  * **handler** - The function name designated to handle the API endpoint.

### Config.json

This is the configuration file for your DApp.

In the below example we only define an array of peers. But feel free to add your own additional parameters here:

```json
{
	"peers": [
	]
}
```

To access a DApp's configuration within Crypti use the `library.config` object.

### Genesis.json

This file contains important details about your DApp's genesis block. This file is automatically generated and should only be modified using: **crypti-cli**.

### Blockchain.json

This file contains your DApp's SQL database schema definition.

You can read more about it in our [Messaging DApp Tutorial](https://github.com/crypti/crypti-dapps-docs/blob/master/MessagingDAppTutorial.md).

### Modules

This folder contains the modules which define the API, contracts and logic of your DApp.

  * **api** - API allowing developers to communicate with Crypti from the VM.
  * **blockchain** - Sidechain logic, include accounts, blocks, loader, dapp forgers, transaction work, etc.
  * **contracts** - Where your DApp's contract logic is defined.
  * **helpers** - Various code helper functions.
  * **logic** - Additional logic for blocks and transactions.
  * **system** - Various system helper functions.

Modules execute upon calling the `onBind` event handler function.

Any logic affecting the **blockchain** should only execute after the `onBlockchainLoaded` event handler function has been called.

For the sake of simplicity, 90% of your time will be spent within the **contracts** folder.

A little later, we will provide further documentation about each module and how they each work.

### Event Handling

The toolkit has its own an event handler. To send notifications of an event, use the `library.bus.message` function like so:

```js
library.bus.message("event", {});
```

To respond to an event. Simply define an event handler function:

```js
MyModule.prototype.onEvent = function (args) {
}
```

Replacing **onEvent** with "on" + the name of the event.
